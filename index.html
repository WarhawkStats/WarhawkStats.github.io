<!DOCTYPE html>
<html>
   <head>
      <title>GreenTie's Warhawk Stats</title>
      <link rel="icon" type="image/x-icon" href="/img/favicon.ico">
      <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
      <meta http-equiv="Pragma" content="no-cache"/>
      <meta http-equiv="Expires" content="0"/>
    </head>

<body>

   <div id="div1">
      <img src="./img/greentiestats.png">

      <p>This is a work in progress. Play on "GreenTie's" Warhawk Server to accumulate stats here.</p>


      <p id="lblLastUpdated">Last Updated:</p>
      <p id="lblTotalGames">Total Games Recorded:</p>


      <style type="text/css">
         .tg {
            border-collapse: collapse;
            border-spacing: 0;
         }

         .tg td {
            border-color: black;
            border-style: solid;
            border-width: 1px;
            font-family: Arial, sans-serif;
            font-size: 14px;
            overflow: hidden;
            padding: 10px 5px;
            word-break: normal;
         }

         .tg th {
            border-color: black;
            border-style: solid;
            border-width: 1px;
            font-family: Arial, sans-serif;
            font-size: 14px;
            font-weight: normal;
            overflow: hidden;
            padding: 10px 5px;
            word-break: normal;
         }

         .tg .tg-0lax {
            text-align: left;
            vertical-align: top
         }

         body {
            background-color: #b8c8ba;
         }
      </style>

      <table id="statdatatable" class="tg">
         <tr>
            <th>Name</th>
            <th>Points</th>
            <th>Kills</th>
            <th>Deaths</th>
            <th>KDR</th>
            <th>Flag Captures</th>
            <th>Games Played</th>
         </tr>
      </table>

   </div>
   <script>

      //fetch function
      let randomNum = Math.floor(Math.random() * 1000);

      fetch('./data.json?'+ randomNum.toString()).then(function (u) { return u.json(); }).then(
         function (json) {
            data_function(json); //calling and passing json to another function data_function
         }
      )
      //another functions
      function data_function(data) {
         //alert(data.length);
         console.log(data)

         let lblLastUpdated = document.getElementById("lblLastUpdated");
         lblLastUpdated.innerText = "Last Updated (Arizona Time) : " + data.date;

         let lblTotalGames = document.getElementById("lblTotalGames");
         lblTotalGames.innerText = "Total Games Recorded : " + data.updateCount;



         for (let i = 0; i < data.playerList.length; i++) {
            //text += cars[i] + "<br>";
            //alert(data.players[i].username);
            let table = document.getElementById("statdatatable");
            //console.log(table)
            // Create row element
            let row = document.createElement("tr")

            //location.reload();

            // Create cells
            let c1 = document.createElement("td")
            let c2 = document.createElement("td")
            let c3 = document.createElement("td")
            let c4 = document.createElement("td")
            let c5 = document.createElement("td")
            let c6 = document.createElement("td")
            let c7 = document.createElement("td")

            // Insert data to cells
            c1.innerText = data.playerList[i].name
            c2.innerText = data.playerList[i].points
            c3.innerText = data.playerList[i].kills
            c4.innerText = data.playerList[i].deaths
            c5.innerText = (data.playerList[i].kills/data.playerList[i].deaths).toFixed(2);
            c6.innerText = data.playerList[i].flags
            c7.innerText = data.playerList[i].games

            // Append cells to row
            row.appendChild(c1);
            row.appendChild(c2);
            row.appendChild(c3);
            row.appendChild(c4);
            row.appendChild(c5);
            row.appendChild(c6);
            row.appendChild(c7);

            // Append row to table body
            table.appendChild(row)
         }
      }

      //console.log({ data })


      //console.log(jsonData);

   </script>
</body>

</html>